<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Marca de agua</title>
</head>
<body>
    <h2>Upload an image to add a watermark</h2>
    <input type="file" id="imageUpload">
    <button onclick="uploadImage()">Upload</button>
    <br><br>
    <img id="watermarkedImage" alt="Watermarked Image">

    <script>
        const validMimeTypes = ['image/jpeg', 'image/png', 'image/bmp', 'image/tiff'];

        async function uploadImage() {
            const fileInput = document.getElementById('imageUpload');
            const file = fileInput.files[0];
            
            if (!validMimeTypes.includes(file.type)) {
                alert("Please upload a valid image file (jpeg, png, bmp, tiff).");
                return;
            }
        
            const formData = new FormData();
            formData.append('image', file);
        
            try {
                const response = await fetch('http://localhost:3000/upload', {
                    method: 'POST',
                    body: formData,
                });
        
                if (!response.ok) {
                    throw new Error('Failed to upload image.');
                }
        
                const blob = await response.blob();
                const imgUrl = URL.createObjectURL(blob);
                document.getElementById('watermarkedImage').src = imgUrl;
            } catch (error) {
                console.error("Error uploading the image:", error);
                alert("Failed to upload image. Please try again.");
            }
        }
    </script>
</body>
</html>